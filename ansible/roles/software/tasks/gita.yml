---
# Gita installation
# For usage see README.md
#
# Source: https://github.com/nosarthur/gita
- name: "[Gita] Install Gita specific version"
  pip:
    name: "gita=={{ versions.gita }}"
    executable: pip3
  register: pip_out
  changed_when: "'Requirement already satisfied' not in pip_out.stdout"
  when: versions['gita'] != 'latest'

- name: "[Gita] Install Gita latest version"
  pip:
    name: "gita"
    executable: pip3
    extra_args: --upgrade
  register: pip_out
  changed_when: "'Requirement already satisfied' not in pip_out.stdout"
  when: versions['gita'] == 'latest'

- name: "[Gita] Get installed Gita version"
  shell: "pip3 show gita | grep Version | awk '{print $2}'"
  changed_when: false
  register: gita_version

- name: "[Gita] Save used version"
  set_fact:
    used_software_versions: "{{ used_software_versions | combine({'gita': gita_version.stdout}) }}"